<!DOCTYPE html>
<html lang="es">
<head>
    <div th:replace="~{fragments/layout :: head(title='Principal')}">

    </div>
    <link rel="stylesheet" href="/css/Inicio.css">
    <script src="../static/js/Inicio.js"></script>
</head>

<body>
    <div th:replace="~{fragments/layout :: nav}">

    </div>

  <a href="#cont_navid" class="btn btn-primary" id="btn_IrArriba">^</a>
  <div class="cont_nav justify-content-center" id="cont_navid">
      <div class="item1" id="item1id" sec:authorize="hasAnyRole('ROLE_DOCENTE')">
          <div class="card">
              <div class="card-body">
                  <h5 class="card-title card-header">Solicitudes de salida</h5>
                  <ul class="list-group list-group-flush">

                      <li class="list-group-item">Conoce el estado de tus solicitudes de salida. Las opciones que puedes elegir son:
                      </li>
                  </ul>
                  <ul class="list-group list-group-flush">
                      <li class="list-group-item"> > Editar solicitud de salida</li>
                      <li class="list-group-item"> > Ver informacion de tus solicitudes</li>
                      <li class="list-group-item"> > Eliminar tus solicitudes</li>
                  </ul>

              </div>
              <div class="card-footer">
                  <a href="#opc1" class="btn btn-primary">Conoce mas...</a>
              </div>
          </div>
      </div>


      <div class="item2" id="item2" sec:authorize="hasAnyRole('ROLE_ADMINISTRACIÓN','ROLE_SUBDIRECTOR', 'ROLE_DIRECTOR')">
          <div class="card">
              <div class="card-body ">
                  <h5 class="card-title card-header">Subir reporte</h5>
                  <ul class="list-group list-group-flush">

                      <li class="list-group-item">
                          Lista de mis reportes de salida que aun se encuentran pendientes por subir
                      </li>
                  </ul>
                  <ul class="list-group list-group-flush">
                      <li class="list-group-item"> > Ver informacion de las solicitudes</li>
                      <li class="list-group-item"> > Subir reporte de salida en formato PDF</li>
                  </ul>
              </div>
              <div class="card-footer">
                  <a href="#opc3" class="btn btn-primary">Conoce mas...</a>
              </div>
          </div>
      </div>

      <div class="item3" id="item3" sec:authorize="hasAnyRole('ROLE_ADMINISTRACIÓN','ROLE_SUBDIRECTOR', 'ROLE_DIRECTOR')">
          <div class="card">
              <div class="card-body">
                  <h5 class="card-title card-header">Firmar reportes</h5>
                  <ul class="list-group list-group-flush">

                      <li class="list-group-item">
                          Mira las solicitudes de salidas que se encuentran pendientes de firmar
                      </li>
                  </ul>
                  <ul class="list-group list-group-flush">
                      <li class="list-group-item"> > Ver informacion de las solicitudes</li>
                      <li class="list-group-item"> > Firmar solicitudes</li>
                      <li class="list-group-item"> > Rechazar solicitudes</li>
                  </ul>
              </div>
              <div class="card-footer">
                  <a href="#opc2" class="btn btn-primary">Conoce mas...</a>
              </div>
          </div>
      </div>

  </div>
  <div class="separadordetablas" id="opc1"></div>

  <div class="solicitudContenedor" sec:authorize="hasAnyRole('ROLE_DOCENTE')"><!--CONTENEDOR TABLA SOLICITUDES DE SALIDA-->
      <img class="htmx-indicator" src="https://i.imgur.com/8THYvPQ.gif">
      <div id="result-accion"></div>
      <h4>Mis solicitudes de salida</h4>
      <table class="table">
          <thead class="table-bordered"><!--ENCABEZADO DE LA TABLA-->
          <tr>
              <th scope="col">Nombre del evento</th>
              <th scope="col">Estado de la solicitud</th>
              <th scope="col">Opciones</th>
          </tr>
          </thead><!--FIN ENCABEZADO DE TABLA-->

          <tbody><!--CUERPO DE LA TABLA-->
          <tr th:each="sol : ${solicitudes}">
              <td th:text="${sol.nombreEvento}"></td>
              <td th:text="${sol.estadoSolicitud}"></td>
              <td>
<!--                  <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#ModalEditarSolicitud">Editar</button>-->
                  <button class="btn btn-dark" data-bs-toggle="modal" data-bs-target="#ModalSolicitudInfo"
                          th:hx-get="'/solicitud?id=' + ${sol.getIdSolicitud}"
                          hx-target="#solicitud-info-body"
                  >
                      ver +
                  </button>
                  <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#ModalEditarSolicitud"
                  		  th:disabled="${sol.idEstadoSolicitud != 1 and sol.idEstadoSolicitud != 7}"
                  		  th:hx-get="'/docente/get-editar-form?id=' + ${sol.getIdSolicitud}"
                          hx-target="#modal-editar-solicitud-body"
                  >Editar</button>
                  <button  id="btn_eliminarslc"
                  th:disabled="${sol.idEstadoSolicitud == 5 or sol.idEstadoSolicitud == 6 or sol.idEstadoSolicitud == 8}"
                  th:onclick="'document.getElementById(\'solicitudCancelar\').value = ' + ${sol.getIdSolicitud}"
                  type="button" class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#modalCancelar">x</button>
                  
<!--                  <button class="btn btn-warning" id="btn_eliminarslc">x</button>-->
              </td>				

          </tr>
          <tr>
              <td colspan="2">IMPORTANTE: *Cuentas con 5 dias habiles para entregar el reporte de salida despues de la fecha de regreso*</td>
              <td>
                  <button 
                  		hx-get="/docente/get-registrar-solicitud-form"
                    	hx-target="#modal-crear-solicitud-body"
                  		class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#ModalCrearSolicitud">
                      Crear nueva solicitud
                  </button>
                  
              </td>
          </tr>

          </tbody><!--FIN CUERPO TABLA-->
      </table>
  </div><!--FIN CONTENEDOR SOLICITUDES-->

  <div class="separadordetablas" id="opc2"></div><!--NO QUITAR LO USO PARA QUE SE ACOMODEN BIEN LAS VISTAS AL USAR LA BARRA DE NAVEGACION-->

  <!--MODAL PARA VER INFORMACION DE SOLICITUD-->
  <div class="modal fade m1" id="ModalSolicitudInfo" tabindex="-1" role="dialog" aria-labelledby="ModalSolicitudInfoLabel" aria-hidden="false">
      <div class="modal-dialog modal-lg" role="document">
          <div class="modal-content" id="cuadroModal">
              <div class="modal-content" id="tituloModal">
                  <h5 class="modal-title" id="ModalSolicitudInfoLabel">Evento:
                      <span id="slc_Evento">Nombre del evento</span>
                  </h5>

              </div>
              <div class="modal-body" id="solicitud-info-body">

              </div>
              <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" onclick="quitarModal(ModalSolicitudInfo)">Cerrar</button>
              </div>
          </div>
      </div>
  </div>
  <!--FIN MODAL VER SOLICITUD INFO-->

  <!--MODAL CANCELAR SOLICITUD-->
<!-- Modal -->
<div class="modal fade" id="modalCancelar" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Cancelar Solicitud</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        ¿Desea cancelar esta solicitud? 
      </div>
      <form
      	hx-post="/docente/cancelar"
      	hx-target="#result-accion"
      	hx-swap="innerHTML"
      >
		<div class="modal-footer">
			<input type="number" name="solicitudCancelar" id="solicitudCancelar" hidden>
	        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
	        <button type="submit" class="btn btn-primary" data-bs-dismiss="modal">Confirmar</button>
      	</div>
	  </form>

    </div>
  </div>
</div>
  <!-- FIN MODAL CANCELAR SOLICITUD -->
  
 <!--MODAL CREAR SOLICITUD-->
 <!-- Modal -->
         <div
            hx-swap="outerHTML"
            hx-trigger="resetForm from:body"
            hx-get="/docente/get-registrar-solicitud-form"
            hx-target="#modal-crear-solicitud-body"
            >
       </div>
 <div class="modal fade" id="ModalCrearSolicitud" tabindex="-1" role="dialog" aria-labelledby="ModalCrearSolicitudTitle" aria-hidden="true">
     <div class="modal-dialog modal-lg" role="document">
         <div class="modal-content">
             <div class="modal-header">
                 <h6 class="modal-title" id="ModalCrearSolicitudTitle">Nueva solicitud</h6>
             </div>
             <div class="modal-body">
                 <form hx-post="/docente/registrar"
				      	hx-target="#result-accion"
				      	hx-swap="innerHTML"
                 		id="crearSolictud"
                 		>
					  <div id="result-msg"></div>
					 
					  <div id="modal-crear-solicitud-body"></div>
				
					  
					   <div id="miModal" class="modalConfirmar">
							<div class="modalConfirmar-content">
							   <p>¿Todos los datos son correctos?</p>
							   <button type="button"  class="btn btn-secondary" onclick="cerrarModal()">Cancelar</button>
							   <button class="btn btn-primary" data-bs-dismiss="modal" onclick="cerrarModal()" type="submit" >Confirmar</button>
							</div>
						</div>
                 </form>
                 <div class="modal-footer">
						<button type="button"  class="btn btn-secondary" onclick="quitarModal(ModalCrearSolicitud)">Cerrar</button>
                 		<button onclick="validarForm()"  id="buttonCrearSolicitud" class="btn btn-primary">Crear solicitud</button>
             	  </div>
             </div>
         </div>
     </div>
 </div>

  <!--FIN MODAL CREAR SOLICITUD-->

  <!--MODAL EDITAR SOLICITUD-->
  <!-- Modal -->
  <div class="modal fade" id="ModalEditarSolicitud" tabindex="-1" role="dialog" aria-labelledby="ModalEditarSolicitudTitle" aria-hidden="true">
      <div class="modal-dialog modal-lg" role="document">
          <div class="modal-content">
              <div class="modal-header">
                  <h6 class="modal-title" id="ModalEditarSolicitudTitle">Editar solicitud</h6>
              </div>
              <div class="modal-body">
                  <form id="form_EditarSolicitud" hx-post="/docente/editar"
				      	hx-target="#result-accion"
				      	hx-swap="innerHTML"
      					hx-indicator=".htmx-indicator"
                 		>
                 	<div id="result-editar"></div>
				  	<div id="modal-editar-solicitud-body"></div>
              
         			<div id="miModalEditar" class="modalConfirmar">
						<div class="modalConfirmar-content">
							   <p>¿Desea guardar los cambios?</p>
							   <button type="button"  class="btn btn-secondary" onclick="miModalEditar()">Cancelar</button>
							   <button class="btn btn-primary" data-bs-dismiss="modal" onclick="cerrarModalEditar()" type="submit" >Confirmar</button>
						</div>
					</div>
                  </form>
              <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" onclick="quitarModal(ModalEditarSolicitud)">Cerrar</button>
                  <button onclick="validarFormEditar()" class="btn btn-primary">Guardar Cambios</button>
              </div>
              </div>

          </div>
      </div>
  </div>
  <!--FIN MODAL EDITAR SOLICITUD-->


  <!--CONTENEDOR TABLA SOLICITUDES POR FIRMAR-->

  <div class="solicitudContenedor" sec:authorize="hasAnyRole('ROLE_ADMINISTRACIÓN','ROLE_SUBDIRECTOR', 'ROLE_DIRECTOR')">
      <h4>Solicitudes pendientes por firmar</h4>
      <table class="table">
          <thead class="table-bordered"><!--ENCABEZADO DE LA TABLA-->
          <tr>
              <th scope="col">Nombre del evento</th>
              <th scope="col">Nombre del solicitante</th>
              <th scope="col">No. Empleado</th>
              <th scope="col">Opciones</th>
          </tr>
          </thead><!--FIN ENCABEZADO DE TABLA-->

          <tbody><!--CUERPO DE LA TABLA-->
          <tr th:each="sol, iter : ${solicitudes_pendientes}">

              <td th:text="${sol.nombreEvento}"></td>
              <td th:text="${usuarios_firmar[iter.index].username} + ' ' + ${usuarios_firmar[iter.index].apPaterno} + ' ' + ${usuarios_firmar[iter.index].apMaterno}"></td>
              <td th:text="${usuarios_firmar[iter.index].numEmpleado}"></td>
              <td>
                  <button class="btn btn-dark" data-bs-toggle="modal" data-bs-target="#ModalSolicitudInfo"
                          th:hx-get="'/solicitud?id=' + ${sol.getIdSolicitud}"
                          hx-target="#solicitud-info-body"
                  >
                      ver +
                  </button>
<!--                  <button class="btn btn-primary" id="btn_Firmar">Firmar</button>-->
<!--                  <button class="btn btn-warning" id="btn_Firmar">Rechazar</button>-->
              </td>

          </tr>
          </tbody><!--FIN CUERPO TABLA-->
      </table>
  </div><!--FIN CONTENEDOR SOLICITUDES POR FIRMAR-->

  <div class="separadordetablas" id="opc3"></div><!--NO QUITAR LO USO PARA QUE SE ACOMODEN BIEN LAS VISTAS AL USAR LA BARRA DE NAVEGACION-->

  <div class="reporteSalida" sec:authorize="hasAnyRole('ROLE_ADMINISTRACIÓN','ROLE_SUBDIRECTOR', 'ROLE_DIRECTOR')">
      <h4>Reportes de salida pendientes</h4>
      <table class="table">
          <thead class="table-bordered"><!--ENCABEZADO DE LA TABLA-->
          <tr>
              <th scope="col">Nombre del evento</th>
              <th scope="col">Archivo PDF</th>
              <th scope="col">Opciones</th>
          </tr>
          </thead>
          <tbody>

          <tr>
              <td>Evento 4</td>
              <td><input type="file" accept=".pdf" id="PDF_ReporteSalida" class="form-control"></td>
              <td><button class="btn btn-dark" data-bs-toggle="modal" data-bs-target="#ModalSolicitudInfo">ver +</button></td>
          </tr>
          <tr>
              <td>Evento 5</td>
              <td><input type="file" accept=".pdf" id="PDF_ReporteSalida" class="form-control"></td>
              <td><button class="btn btn-dark" data-bs-toggle="modal" data-bs-target="#ModalSolicitudInfo">ver +</button></td>
          </tr>
          <tr>
              <td>Evento 6</td>
              <td><input type="file" accept=".pdf" id="PDF_ReporteSalida" class="form-control"></td>
              <td><button class="btn btn-dark" data-bs-toggle="modal" data-bs-target="#ModalSolicitudInfo">ver +</button></td>
          </tr>

          </tbody>
      </table>
  </div>

  <div class="piedepagina">
  </div>
    <script type="text/javascript" src="/js/Inicio.js"></script>
</body>
</html>